æ²¡é—®é¢˜ã€‚è¦ä¿®å¤ç¬¬ä¸€ç‰ˆï¼ˆå¤šæ–‡ä»¶æ¶æ„ï¼‰çš„é—®é¢˜ï¼Œæ ¸å¿ƒåœ¨äº**â€œæ˜ç¡®æ–‡ä»¶ç»“æ„â€å’Œâ€œæ˜¾å¼å¯¼å…¥â€**ã€‚ä¹‹å‰ä¹‹æ‰€ä»¥ç©ºç™½ï¼Œæ˜¯å› ä¸ºä¸»ç¨‹åº app.py æ²¡èƒ½æˆåŠŸæ‰¾åˆ°å¹¶åŠ è½½ commands æ–‡ä»¶å¤¹é‡Œçš„ç±»ã€‚
è¿™æ¬¡æˆ‘ä»¬ä¸å†ç”¨å¤æ‚çš„åŠ¨æ€æ‰«æï¼Œè€Œæ˜¯é‡‡ç”¨æœ€ç¨³å¥çš„**â€œæ˜¾å¼å¼•ç”¨â€**æ–¹å¼ã€‚
è¯·æŒ‰ç…§ä»¥ä¸‹ 4 ä¸ªæ­¥éª¤ï¼Œä¸¥æ ¼åˆ›å»ºæ–‡ä»¶å’Œæ–‡ä»¶å¤¹ã€‚
ç¬¬ä¸€æ­¥ï¼šå»ºç«‹ç›®å½•ç»“æ„
è¯·å…ˆæ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ˆä¾‹å¦‚å« ops_toolï¼‰ï¼Œç„¶ååœ¨é‡Œé¢åˆ›å»ºå¦‚ä¸‹ç»“æ„ï¼š
ops_tool/                <-- é¡¹ç›®æ ¹ç›®å½•
â”œâ”€â”€ app.py               <-- ä¸»ç¨‹åº
â””â”€â”€ commands/            <-- å­˜æ”¾å…·ä½“å‘½ä»¤çš„åŒ… (æ³¨æ„è¦æœ‰ s)
    â”œâ”€â”€ __init__.py      <-- å¿…é¡»æœ‰è¿™ä¸ªæ–‡ä»¶ (å†…å®¹å¯ä»¥ä¸ºç©º)
    â”œâ”€â”€ base.py          <-- å­˜æ”¾åŸºç±»
    â””â”€â”€ linux_ops.py     <-- å­˜æ”¾ Linux ç›¸å…³çš„å‘½ä»¤

ç¬¬äºŒæ­¥ï¼šåˆ›å»ºæ ¸å¿ƒæ–‡ä»¶
è¯·ä¾æ¬¡å¤åˆ¶ä»¥ä¸‹ä»£ç åˆ°å¯¹åº”çš„æ–‡ä»¶ä¸­ã€‚
1. commands/__init__.py
 * å†…å®¹ï¼šç©ºæ–‡ä»¶å³å¯ã€‚
 * ä½œç”¨ï¼šå‘Šè¯‰ Python è¿™ä¸ªæ–‡ä»¶å¤¹æ˜¯ä¸€ä¸ªâ€œåŒ…â€ï¼Œå…è®¸è¢« importã€‚
2. commands/base.py (åŸºç±»)
å®šä¹‰æ‰€æœ‰å‘½ä»¤å¿…é¡»éµå®ˆçš„è§„åˆ™ã€‚
# æ–‡ä»¶ä½ç½®: commands/base.py
from abc import ABC, abstractmethod
from typing import List, Dict, Any

class CommandStrategy(ABC):
    @property
    @abstractmethod
    def name(self) -> str:
        pass

    @property
    @abstractmethod
    def description(self) -> str:
        pass

    @abstractmethod
    def get_params_schema(self) -> List[Dict[str, Any]]:
        pass

    @abstractmethod
    def generate(self, params: Dict[str, Any]) -> str:
        pass

3. commands/linux_ops.py (å…·ä½“å®ç°)
è¿™æ˜¯å…·ä½“çš„ Linux å‘½ä»¤é€»è¾‘ã€‚æ³¨æ„è¿™é‡Œä½¿ç”¨äº† from .base (ç›¸å¯¹å¯¼å…¥)ã€‚
# æ–‡ä»¶ä½ç½®: commands/linux_ops.py
from .base import CommandStrategy
from jinja2 import Template
import shlex

class FindLargeFilesCommand(CommandStrategy):
    name = "Linux: æŸ¥æ‰¾å¤§æ–‡ä»¶"
    description = "åœ¨æŒ‡å®šç›®å½•ä¸‹æŸ¥æ‰¾è¶…è¿‡ç‰¹å®šå¤§å°çš„æ–‡ä»¶ã€‚"

    def get_params_schema(self):
        return [
            {"name": "path", "label": "æœç´¢è·¯å¾„", "type": "text", "default": "/var/log"},
            {"name": "size_mb", "label": "æœ€å°ä½“ç§¯(MB)", "type": "number", "default": 100},
            {"name": "action", "label": "æ‰§è¡ŒåŠ¨ä½œ", "type": "select", "options": ["åªæ˜¾ç¤º", "åˆ é™¤", "è¯¦æƒ…"]}
        ]

    def generate(self, params):
        template_str = """
        find {{ path }} -type f -size +{{ size }}M
        {%- if action == 'åˆ é™¤' %} -delete
        {%- elif action == 'è¯¦æƒ…' %} -exec ls -lh {} +
        {%- else %} -print
        {%- endif -%}
        """
        # å®‰å…¨å¤„ç†
        safe_path = shlex.quote(params.get("path", "."))
        
        t = Template(template_str)
        return t.render(
            path=safe_path,
            size=params.get("size_mb"),
            action=params.get("action")
        ).strip().replace('\n', ' ')

ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºä¸»ç¨‹åº app.py
è¿™æ˜¯ä¿®å¤çš„å…³é”®ã€‚æˆ‘ä»¬ä½¿ç”¨æ˜¾å¼å¯¼å…¥ (from commands.linux_ops import ...)ï¼Œç¡®ä¿ç¨‹åºä¸€å®šèƒ½æ‰¾åˆ°é‚£ä¸ªç±»ã€‚
# æ–‡ä»¶ä½ç½®: app.py
import streamlit as st
from typing import Dict

# === å…³é”®ä¿®å¤ï¼šæ˜¾å¼å¯¼å…¥ä½ çš„å‘½ä»¤ç±» ===
# åªè¦è¿™é‡Œä¸æŠ¥é”™ï¼Œä¸‹æ‹‰èœå•å°±ä¸€å®šä¼šæœ‰ä¸œè¥¿
from commands.linux_ops import FindLargeFilesCommand

# å¦‚æœä½ ä»¥ååŠ äº† sql_ops.pyï¼Œå°±åœ¨è¿™é‡ŒåŠ ä¸€è¡Œ:
# from commands.sql_ops import MySQLDumpCommand

def main():
    st.set_page_config(page_title="Ops Generator", layout="wide")
    st.title("ğŸ› ï¸ è¿ç»´å‘½ä»¤ç”Ÿæˆå™¨ (å¤šæ–‡ä»¶ç‰ˆ)")

    # 1. æ³¨å†Œå‘½ä»¤
    # æŠŠå¯¼å…¥çš„ç±»å®ä¾‹åŒ–ï¼Œæ”¾è¿›åˆ—è¡¨
    commands_list = [
        FindLargeFilesCommand(),
        # MySQLDumpCommand(), 
    ]
    
    # è½¬ä¸ºå­—å…¸
    cmd_map = {cmd.name: cmd for cmd in commands_list}

    # 2. ä¾§è¾¹æ 
    selected_name = st.sidebar.selectbox("é€‰æ‹©å‘½ä»¤", options=cmd_map.keys())

    # 3. æ¸²æŸ“é€»è¾‘
    if selected_name:
        strategy = cmd_map[selected_name]
        st.header(strategy.name)
        st.info(strategy.description)

        # åŠ¨æ€ç”Ÿæˆè¡¨å•
        with st.form("gen_form"):
            user_inputs = {}
            schema = strategy.get_params_schema()
            
            for field in schema:
                label = field["label"]
                key = field["name"]
                ftype = field["type"]
                default = field.get("default")
                options = field.get("options")

                if ftype == "text":
                    user_inputs[key] = st.text_input(label, value=default)
                elif ftype == "number":
                    user_inputs[key] = st.number_input(label, value=default)
                elif ftype == "select":
                    user_inputs[key] = st.selectbox(label, options=options)
            
            submitted = st.form_submit_button("ç”Ÿæˆ")

        if submitted:
            result = strategy.generate(user_inputs)
            st.success("ç”Ÿæˆç»“æœï¼š")
            st.code(result, language="bash")

if __name__ == "__main__":
    main()

ç¬¬å››æ­¥ï¼šè¿è¡ŒéªŒè¯
 * æ‰“å¼€ç»ˆç«¯ï¼ˆå‘½ä»¤è¡Œï¼‰ã€‚
 * è¿›å…¥ ops_tool æ–‡ä»¶å¤¹ï¼š
   cd ops_tool

 * è¿è¡Œï¼š
   streamlit run app.py

ä¸ºä»€ä¹ˆè¿™æ¬¡ä¸€å®šè¡Œï¼Ÿ
å› ä¸ºæˆ‘åœ¨ app.py é‡Œå†™æ­»äº† from commands.linux_ops import FindLargeFilesCommandã€‚
å¦‚æœä½ çš„æ–‡ä»¶å¤¹ç»“æ„ä¸å¯¹ï¼ˆæ¯”å¦‚å°‘äº†ä¸ª sï¼Œæˆ–è€… __init__.py æ²¡å»ºï¼‰ï¼Œç¨‹åºå¯åŠ¨æ—¶å°±ä¼šç›´æ¥æŠ¥é”™å‘Šè¯‰ä½ æ‰¾ä¸åˆ°æ¨¡å—ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºä¸€ä¸ªç©ºç™½çš„ä¸‹æ‹‰èœå•è®©ä½ çŒœåŸå› ã€‚
å¦‚ä½•æ·»åŠ æ–°å‘½ä»¤ï¼Ÿ
 * å¤åˆ¶ commands/linux_ops.py ä¸º commands/sql_ops.pyã€‚
 * ä¿®æ”¹é‡Œé¢çš„ç±»åå’Œé€»è¾‘ã€‚
 * å» app.py é¡¶éƒ¨åŠ ä¸€è¡Œ from commands.sql_ops import æ–°ç±»åã€‚
 * æŠŠæ–°ç±»åŠ åˆ° commands_list åˆ—è¡¨é‡Œã€‚
