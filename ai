æ²¡é—®é¢˜ï¼æ—¢ç„¶ä»£ç åŸºç¡€è–„å¼±ï¼Œæˆ‘ä»¬å°±ä¸è¦ä¸€æ¬¡æ€§æŠŠæ‰€æœ‰æ–‡ä»¶éƒ½å †ä¸Šæ¥ï¼Œé‚£æ ·å®¹æ˜“ä¹±ã€‚
æˆ‘ä»¬é‡‡ç”¨**â€œæ­ç§¯æœ¨â€**çš„ç­–ç•¥ï¼š
 * å…ˆå»ºå¥½æ–‡ä»¶å¤¹ï¼ˆæ­æ¶å­ï¼‰ã€‚
 * å…ˆæå®šæ ¸å¿ƒæ ·å¼å’ŒåŸºç¡€åŠŸèƒ½ï¼ˆæ‰“åœ°åŸºï¼‰ã€‚
 * ç¡®ä¿ç¨‹åºèƒ½è·‘èµ·æ¥ï¼Œå†å¾€é‡Œå¡«å†…å®¹ã€‚
è¿™æ˜¯ç¬¬ä¸€é˜¶æ®µï¼Œæˆ‘ä»¬å…ˆæŠŠé¡¹ç›®ç»“æ„ã€ç¾åŒ–åŒ…ï¼ˆCSSï¼‰ å’Œ æ•°æ®ç®¡ç†æ ¸å¿ƒï¼ˆCoreï¼‰ å»ºå¥½ã€‚
ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºæ–‡ä»¶å¤¹ç»“æ„
è¯·åœ¨ä½ å­˜æ”¾ä»£ç çš„ç›®å½•ä¸‹ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å« cmd_generatorã€‚
è¿›å…¥è¿™ä¸ªæ–‡ä»¶å¤¹ï¼Œç„¶ååˆ›å»ºä»¥ä¸‹å­æ–‡ä»¶å¤¹ï¼ˆå¦‚æœä¸ä¼šç”¨å‘½ä»¤è¡Œï¼Œç›´æ¥åœ¨Windows/Macçš„æ–‡ä»¶ç®¡ç†å™¨é‡Œå³é”®æ–°å»ºæ–‡ä»¶å¤¹å³å¯ï¼‰ï¼š
cmd_generator/
  â”œâ”€â”€ assets/          <-- ç”¨æ¥æ”¾å›¾ç‰‡å’Œæ ·å¼æ–‡ä»¶
  â”œâ”€â”€ core/            <-- ç”¨æ¥æ”¾å¤„ç†æ•°æ®çš„æ ¸å¿ƒä»£ç 
  â”œâ”€â”€ views/           <-- ç”¨æ¥æ”¾ä¸åŒçš„ç•Œé¢ï¼ˆåç»­å†åŠ ï¼‰
  â””â”€â”€ data/            <-- ç”¨æ¥å­˜ä½ çš„ json æ•°æ®æ–‡ä»¶ï¼ˆå…ˆå»ºå¥½ï¼Œä¿æŒæ•´æ´ï¼‰

å»ºå¥½åï¼Œæˆ‘ä»¬å¼€å§‹åˆ›å»ºæ–‡ä»¶ã€‚
ç¬¬äºŒæ­¥ï¼šæ³¨å…¥çµé­‚ï¼ˆæ ·å¼æ–‡ä»¶ï¼‰
è¿™ä¸ªæ–‡ä»¶è´Ÿè´£è®©ç•Œé¢â€œçœ‹èµ·æ¥é«˜çº§â€ã€‚æˆ‘ä»¬è¦æŠŠåŸæ¥ Streamlit åœŸæ°”çš„ç™½è‰²èƒŒæ™¯å’Œç›´è§’è¾¹æ¡†æ”¹æˆå¡ç‰‡å¼è®¾è®¡ã€‚
æ–‡ä»¶è·¯å¾„ï¼šassets/style.css
æ“ä½œï¼šåœ¨ assets æ–‡ä»¶å¤¹é‡Œæ–°å»º style.cssï¼Œç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š
/* assets/style.css */

/* 1. å…¨å±€å­—ä½“ä¼˜åŒ– (ä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„é«˜çº§ç­‰å®½å­—ä½“) */
code {
    font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace !important;
    font-size: 0.9rem !important;
}

/* 2. éšè— Streamlit é»˜è®¤çš„å³ä¸Šè§’èœå•å’Œé¡µè„šï¼Œçœ‹èµ·æ¥åƒç‹¬ç«‹APP */
#MainMenu {visibility: hidden;}
footer {visibility: hidden;}
header {visibility: hidden;}

/* 3. è‡ªå®šä¹‰å¡ç‰‡æ ·å¼ (è¿™æ˜¯é«˜çº§æ„Ÿçš„å…³é”®) */
/* æˆ‘ä»¬ä¼šåœ¨ä»£ç é‡Œç”¨ <div class="cmd-card"> åŒ…è£¹å†…å®¹ */
.cmd-card {
    background-color: #ffffff;
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 15px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); /* è½»å¾®çš„é˜´å½± */
    border: 1px solid #f0f2f6;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.cmd-card:hover {
    transform: translateY(-2px); /* é¼ æ ‡æ‚¬åœå¾®å¾®ä¸Šæµ® */
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
}

/* 4. ä¼˜åŒ–ä¾§è¾¹æ èƒŒæ™¯ */
[data-testid="stSidebar"] {
    background-color: #f8f9fa;
    border-right: 1px solid #e0e0e0;
}

/* 5. è°ƒæ•´æ ‡é¢˜é—´è·ï¼Œä¸è¦å¤ªæ¾æ•£ */
h3 {
    padding-top: 0 !important;
    margin-top: 0 !important;
}

ç¬¬ä¸‰æ­¥ï¼šæ ¸å¿ƒé€»è¾‘â€”â€”Tag ç®¡ç†å™¨
ä½ æœ€ä¸æ»¡æ„ Tag ç®¡ç†ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæŠŠå®ƒçš„å¤§è„‘å†™å¥½ã€‚è¿™ä¸ªæ–‡ä»¶è´Ÿè´£è¯»å–å’Œä¿å­˜ Tagï¼Œå¢åŠ äº†è‡ªåŠ¨å¤‡ä»½å’Œé”™è¯¯å¤„ç†ï¼Œé˜²æ­¢ä½ æ‰‹è¯¯åˆ äº†æ–‡ä»¶ã€‚
æ–‡ä»¶è·¯å¾„ï¼šcore/tag_manager.py
æ“ä½œï¼šåœ¨ core æ–‡ä»¶å¤¹é‡Œæ–°å»º tag_manager.pyï¼Œç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š
# core/tag_manager.py
import json
import os
import uuid

# æ•°æ®æ–‡ä»¶é»˜è®¤å­˜åœ¨ data ç›®å½•ä¸‹
DATA_FILE = os.path.join("data", "tags.json")

class TagManager:
    def __init__(self):
        self.filepath = DATA_FILE
        self._ensure_file()

    def _ensure_file(self):
        """ç¡®ä¿æ–‡ä»¶å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨å°±åˆ›å»ºä¸€ä¸ªå¸¦é»˜è®¤æ•°æ®çš„"""
        if not os.path.exists(self.filepath):
            default_data = {
                "tags": {
                    "t1": {"name": "MySQL", "category": "Database", "color": "#FF6B6B"},
                    "t2": {"name": "Linux", "category": "OS", "color": "#4D96FF"},
                    "t3": {"name": "Docker", "category": "Container", "color": "#6BCB77"}
                },
                "categories": ["Database", "OS", "Container", "Network", "AI"]
            }
            # è‡ªåŠ¨åˆ›å»ºç›®å½•
            os.makedirs(os.path.dirname(self.filepath), exist_ok=True)
            with open(self.filepath, 'w', encoding='utf-8') as f:
                json.dump(default_data, f, indent=4, ensure_ascii=False)

    def load_data(self):
        """è¯»å–æ•°æ®"""
        try:
            with open(self.filepath, 'r', encoding='utf-8') as f:
                return json.load(f)
        except Exception as e:
            return {"tags": {}, "categories": []}

    def save_data(self, data):
        """ä¿å­˜æ•°æ®"""
        with open(self.filepath, 'w', encoding='utf-8') as f:
            json.dump(data, f, indent=4, ensure_ascii=False)

    # --- ä¾›ç•Œé¢è°ƒç”¨çš„ç®€å•æ¥å£ ---

    def get_all_tags(self):
        """è·å–æ‰€æœ‰ Tag å­—å…¸"""
        return self.load_data().get("tags", {})

    def get_categories(self):
        """è·å–æ‰€æœ‰åˆ†ç±»åˆ—è¡¨"""
        return self.load_data().get("categories", ["General"])

    def add_tag(self, name, category, color):
        """æ–°å¢ä¸€ä¸ª Tag"""
        data = self.load_data()
        # ç”Ÿæˆä¸€ä¸ªéšæœºIDï¼Œé˜²æ­¢åå­—é‡å¤å†²çª
        new_id = str(uuid.uuid4())[:8]
        data["tags"][new_id] = {
            "name": name,
            "category": category,
            "color": color
        }
        self.save_data(data)
        return True
    
    def add_category(self, cat_name):
        """æ–°å¢åˆ†ç±»"""
        data = self.load_data()
        if cat_name not in data["categories"]:
            data["categories"].append(cat_name)
            self.save_data(data)

    def delete_tag(self, tag_id):
        """åˆ é™¤ Tag"""
        data = self.load_data()
        if tag_id in data["tags"]:
            del data["tags"][tag_id]
            self.save_data(data)

ç¬¬å››æ­¥ï¼šæ ¸å¿ƒé€»è¾‘â€”â€”æ¨¡æ¿é…ç½®ç®¡ç†å™¨
è¿™ä¸ªæ–‡ä»¶è´Ÿè´£å¤„ç†ä½ çš„å‘½ä»¤æ¨¡æ¿ï¼ˆCRUDï¼‰ã€‚
æ–‡ä»¶è·¯å¾„ï¼šcore/config_manager.py
æ“ä½œï¼šåœ¨ core æ–‡ä»¶å¤¹é‡Œæ–°å»º config_manager.pyï¼Œç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š
# core/config_manager.py
import json
import os

DATA_FILE = os.path.join("data", "templates.json")

class ConfigManager:
    def __init__(self):
        self.filepath = DATA_FILE
        self._ensure_file()

    def _ensure_file(self):
        if not os.path.exists(self.filepath):
            default_data = {} # é»˜è®¤ä¸ºç©º
            os.makedirs(os.path.dirname(self.filepath), exist_ok=True)
            with open(self.filepath, 'w', encoding='utf-8') as f:
                json.dump(default_data, f, ensure_ascii=False)

    def get_all_templates(self):
        try:
            with open(self.filepath, 'r', encoding='utf-8') as f:
                return json.load(f)
        except:
            return {}

    def save_template(self, tid, template_data, source="team"):
        """ä¿å­˜æˆ–æ›´æ–°æ¨¡æ¿"""
        data = self.get_all_templates()
        template_data['source'] = source # æ ‡è®°æ¥æº
        data[tid] = template_data
        
        with open(self.filepath, 'w', encoding='utf-8') as f:
            json.dump(data, f, indent=4, ensure_ascii=False)
            
    def delete_template(self, tid):
        data = self.get_all_templates()
        if tid in data:
            del data[tid]
            with open(self.filepath, 'w', encoding='utf-8') as f:
                json.dump(data, f, indent=4, ensure_ascii=False)

ç¬¬äº”æ­¥ï¼šä¸»ç¨‹åºå…¥å£ (App Shell)
è¿™æ˜¯æ•´ä¸ªç¨‹åºçš„éª¨æ¶ã€‚æˆ‘ä»¬å…ˆä¸å†™å¤æ‚çš„ç•Œé¢ï¼Œå…ˆæŠŠå¯¼èˆªæ æ­èµ·æ¥ï¼Œæµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬çš„CSSæœ‰æ²¡æœ‰ç”Ÿæ•ˆã€‚
æ–‡ä»¶è·¯å¾„ï¼šapp.py (ç›´æ¥åœ¨ cmd_generator æ ¹ç›®å½•ä¸‹)
æ“ä½œï¼šç²˜è´´ä»¥ä¸‹å†…å®¹ï¼š
# app.py
import streamlit as st
import streamlit_antd_components as sac
import os

# è®¾ç½®é¡µé¢é…ç½® (å¿…é¡»æ˜¯ç¬¬ä¸€è¡Œä»£ç )
st.set_page_config(
    page_title="Command Workspace",
    page_icon="ğŸš€",
    layout="wide",
    initial_sidebar_state="expanded"
)

# --- åŠ è½½ CSS æ ·å¼çš„å‡½æ•° ---
def load_css(file_name):
    with open(file_name) as f:
        st.markdown(f'<style>{f.read()}</style>', unsafe_allow_html=True)

# åŠ è½½æˆ‘ä»¬å†™çš„ style.css
css_path = os.path.join("assets", "style.css")
if os.path.exists(css_path):
    load_css(css_path)

# --- ä¾§è¾¹æ å¯¼èˆª (Sidebar Navigation) ---
with st.sidebar:
    st.image("https://cdn-icons-png.flaticon.com/512/906/906324.png", width=50) # æ”¾ä¸ªä¸´æ—¶LOGO
    st.markdown("### cmd_gen v2.0")
    
    # ä½¿ç”¨ Antd çš„é«˜çº§èœå•ç»„ä»¶
    menu = sac.menu([
        sac.MenuItem('æ§åˆ¶å°', icon='terminal', description='Command Hub'),
        sac.MenuItem('æ ‡ç­¾å·¥åŠ', icon='tags', description='Tag Studio'),
        sac.MenuItem('ç¼–è¾‘å™¨', icon='pen', description='Template Editor'),
        sac.MenuItem('æ•°æ®çœ‹æ¿', icon='bar-chart', disabled=True), # æš‚æ—¶ç¦ç”¨
    ], open_all=True, size='middle', variant='filled', color='indigo')

# --- ä¸»ç•Œé¢è·¯ç”±é€»è¾‘ ---
if menu == 'æ§åˆ¶å°':
    st.title("ğŸš€ å‘½ä»¤æ§åˆ¶å°")
    st.info("è¿™é‡Œå°†å±•ç¤ºæœç´¢å’Œè¿è¡Œç•Œé¢... (ä¸‹ä¸€é˜¶æ®µå¼€å‘)")
    
    # æµ‹è¯•ä¸€ä¸‹æˆ‘ä»¬çš„å¡ç‰‡æ ·å¼
    st.markdown("""
    <div class="cmd-card">
        <h3>æµ‹è¯•å¡ç‰‡</h3>
        <p>å¦‚æœä½ çœ‹åˆ°è¿™ä¸ªç™½è‰²çš„å¸¦é˜´å½±çš„æ¡†æ¡†ï¼Œè¯´æ˜ CSS åŠ è½½æˆåŠŸäº†ï¼</p>
    </div>
    """, unsafe_allow_html=True)

elif menu == 'æ ‡ç­¾å·¥åŠ':
    st.title("ğŸ·ï¸ æ ‡ç­¾ä¸åˆ†ç±»å·¥åŠ")
    st.info("è¿™é‡Œå°†å±•ç¤ºé«˜çº§çš„ Tag ç®¡ç†çœ‹æ¿... (ä¸‹ä¸€é˜¶æ®µå¼€å‘)")

elif menu == 'ç¼–è¾‘å™¨':
    st.title("ğŸ“ æ¨¡æ¿ç¼–è¾‘å™¨")
    st.info("è¿™é‡Œå°†å±•ç¤ºåŒæ ç¼–è¾‘ç•Œé¢... (ä¸‹ä¸€é˜¶æ®µå¼€å‘)")


âœ… ç¬¬ä¸€é˜¶æ®µæ£€æŸ¥ç‚¹
ç°åœ¨ä½ çš„æ–‡ä»¶å¤¹ç»“æ„åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š
cmd_generator/
  â”œâ”€â”€ app.py
  â”œâ”€â”€ assets/
  â”‚    â””â”€â”€ style.css
  â”œâ”€â”€ core/
  â”‚    â”œâ”€â”€ tag_manager.py
  â”‚    â””â”€â”€ config_manager.py
  â””â”€â”€ data/ (è¿™ä¸ªå¯èƒ½æ˜¯ç©ºçš„ï¼Œè¿è¡Œç¨‹åºåä¼šè‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶)

å¦‚ä½•è¿è¡Œï¼š
ä½ éœ€è¦å®‰è£…ä¸€ä¸ªæ–°çš„åº“ streamlit-antd-components (ç”¨äºç¾åŒ–èœå•)ï¼Œè¯·åœ¨ç»ˆç«¯è¿è¡Œï¼š
pip install streamlit streamlit-antd-components

ç„¶åå¯åŠ¨ï¼š
streamlit run app.py

è¯·å°è¯•è¿è¡Œä¸€ä¸‹ã€‚ å¦‚æœä½ èƒ½çœ‹åˆ°å·¦ä¾§æ¼‚äº®çš„èœå•ï¼Œå’Œå³ä¾§ä¸€ä¸ªå¸¦é˜´å½±çš„â€œæµ‹è¯•å¡ç‰‡â€ï¼Œè¯´æ˜åœ°åŸºæ‰“å¥½äº†ã€‚
å¦‚æœæˆåŠŸï¼Œè¯·å›å¤â€œOKâ€ï¼Œæˆ‘ä»¬ç«‹åˆ»è¿›å…¥ç¬¬äºŒé˜¶æ®µï¼šå¼€å‘é‚£ä¸ªçœ‹èµ·æ¥å¾ˆé«˜çº§çš„â€œTag æ ‡ç­¾å·¥åŠâ€ã€‚
